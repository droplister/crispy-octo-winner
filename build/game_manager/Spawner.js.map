{"version":3,"sources":["../../src/game_manager/Spawner.js"],"names":["Spawner","config","spawnLocations","addObject","deleteObject","moveObjects","id","spawnInterval","limit","objectType","spawnerType","objectsCreated","start","interval","setInterval","length","spawnObject","SpawnerType","MONSTER","moveMonsters","CHEST","spawnChest","spawnMonster","location","pickRandomLocation","chest","ChestModel","push","monsterNum","attack","health","monster","MonsterModel","Math","floor","random","invalidLocation","some","obj","x","y","filter","moveMonsterInterval","forEach","move"],"mappings":"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","sourcesContent":["import { SpawnerType, randomNumber } from './utils';\nimport ChestModel from './ChestModel';\nimport MonsterModel from './MonsterModel';\n\nexport default class Spawner {\n  constructor(config, spawnLocations, addObject, deleteObject, moveObjects) {\n    this.id = config.id;\n    this.spawnInterval = config.spawnInterval;\n    this.limit = config.limit;\n    this.objectType = config.spawnerType;\n    this.spawnLocations = spawnLocations;\n    this.addObject = addObject;\n    this.deleteObject = deleteObject;\n    this.objectsCreated = [];\n    this.start();\n    this.moveObjects = moveObjects;\n  }\n\n  start() {\n    this.interval = setInterval(() => {\n      if (this.objectsCreated.length < this.limit) {\n        this.spawnObject();\n      }\n    }, this.spawnInterval);\n    if (this.objectType === SpawnerType.MONSTER) {\n      this.moveMonsters();\n    }\n  }\n\n  spawnObject() {\n    if (this.objectType === SpawnerType.CHEST) {\n      this.spawnChest();\n    } else if (this.objectType === SpawnerType.MONSTER) {\n      this.spawnMonster();\n    }\n  }\n\n  spawnChest() {\n    const location = this.pickRandomLocation();\n    const chest = new ChestModel(location[0], location[1], randomNumber(1, 21), this.id);\n    this.objectsCreated.push(chest);\n    this.addObject(chest.id, chest);\n  }\n\n  spawnMonster() {\n    const monsterNum = randomNumber(0, 20);\n    const attack = (monsterNum + 1) * 2;\n    const health = (monsterNum + 1) * 4;\n    const location = this.pickRandomLocation();\n    // console.log('health: '+health);\n    const monster = new MonsterModel(\n      location[0],\n      location[1],\n      randomNumber(21, 21 + attack + health), // coins drop more powerful more likely to drop coins\n      this.id,\n      monsterNum,\n      health,\n      attack,\n    );\n    this.objectsCreated.push(monster);\n    this.addObject(monster.id, monster);\n  }\n\n  pickRandomLocation() {\n    const location = this.spawnLocations[Math.floor(Math.random() * this.spawnLocations.length)];\n    // some used in an interesting way here\n    const invalidLocation = this.objectsCreated.some((obj) => {\n      if (obj.x === location[0] && obj.y === location[1]) {\n        return true;\n      }\n      return false;\n    });\n    if (invalidLocation) {\n      // console.log('this seems like a bad idea..but logging here');\n      return this.pickRandomLocation();\n    }\n    return location;\n  }\n\n  removeObject(id) {\n    // filter will return the objects inside our current array that meets\n    // the true value that we specified in the call back\n    // we want to get back the id's minus the one we passed in\n    this.objectsCreated = this.objectsCreated.filter((obj) => obj.id !== id);\n    this.deleteObject(id);\n  }\n\n  moveMonsters() {\n    this.moveMonsterInterval = setInterval(() => {\n      this.objectsCreated.forEach((monster) => {\n        monster.move();\n      });\n      this.moveObjects();\n    }, 4000);\n  }\n}\n"],"file":"Spawner.js"}